{% extends 'properties/base.html' %}
{% load humanize %}

{% block title %}홈 - Better My house{% endblock %}

{% block content %}
<div class="hero-section text-center text-white py-5 mb-4">
    <div class="hero-overlay">
        <h1 class="display-5 fw-bold">어떤 집을 찾고 계세요?</h1>
        <div class="col-lg-6 mx-auto">
            <p class="lead mb-4">원룸, 투룸, 아파트, 오피스텔까지. 원하는 매물을 찾아보세요.</p>
            <form class="input-group input-group-lg mb-3" action="{% url 'properties:property_list' %}" method="get">
                <input type="text" class="form-control" placeholder="지역, 지하철역, 단지명으로 검색" aria-label="검색어" name="q">
                <button class="btn btn-primary" type="submit">검색</button>
            </form>
        </div>
    </div>
</div>

<div class="container">
    <h2 class="h4 mb-3">매물 목록</h2>
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4 mb-5">
        {% for property in properties %}
        <div class="col">
            <div class="card h-100">
                <a href="{% url 'properties:property_detail' property.pk %}" class="stretched-link"></a>
                {% if property.image %}
                <img src="{{ property.image.url }}" class="card-img-top" alt="{{ property.title }}"
                     style="height: 200px; object-fit: cover;">
                {% else %}
                <div class="d-flex align-items-center justify-content-center card-img-top bg-secondary text-white"
                     style="height: 200px;">
                    이미지 없음
                </div>
                {% endif %}
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title h6">{{ property.title }}</h5>
                    <p class="card-text small text-truncate">{{ property.description|truncatewords:20 }}</p>
                    <p class="card-text small">지역: {{ property.region }}</p>
                    <h6 class="card-subtitle mt-auto fw-bold">{{ property.price|floatformat:"0"|intcomma }}원</h6>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col">
            <div class="alert alert-secondary text-center" role="alert">
                등록된 매물이 없습니다.
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="row g-5">
        <div class="col-md-4">
            <div class="info-section">
                <h4><a href="{% url 'properties:news' %}">부동산 뉴스</a></h4>
                <ul class="list-unstyled">
                    {% for item in news_list %}
                    <li>
                        <a href="#">{{ item.title|truncatechars:25 }}</a>
                        <span class="date">{{ item.date|date:"m.d" }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="col-md-4">
            <div class="info-section">
                <h4><a href="{% url 'properties:weather' %}">오늘의 날씨</a></h4>
                <ul class="list-unstyled">
                    {% for item in weather_list %}
                    <li class="d-flex align-items-center mb-2">
                        <i class="{{ item.icon }} fa-fw me-2 text-muted"></i>
                        <span>{{ item.location }}: {{ item.temp }}, {{ item.condition }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="col-md-4">
            <div class="info-section">
                <h4><a href="{% url 'properties:announcements' %}">공지사항</a></h4>
                <ul class="list-unstyled">
                    {% for item in announcements_list %}
                    <li>
                        <a href="{% url 'properties:announcement_detail' item.pk %}">{{ item.title|truncatechars:25
                            }}</a>
                        <span class="date">{{ item.date|date:"m.d" }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}